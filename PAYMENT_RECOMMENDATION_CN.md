# 国内支付接入建议（可执行版）

## 1. 背景与目标

当前目标是为国内用户提供稳定的支付体验，并尽量接近「统一收银台」效果，同时控制成本与研发复杂度。

关键约束：

- 需要支持微信/支付宝（可扩展银联）
- 希望前端能“直接调出页面”式体验
- 年交易规模预估约 10 万人民币

---

## 2. 结论（先给建议）

**推荐路线：官方直连（微信 + 支付宝） + 自研轻收银台页面。**

不推荐以 Ping++ 作为长期主方案，原因是当前交易规模下平台年费占比高，且国内场景可通过自研页面实现与托管页接近的体验。

---

## 3. 为什么这样选

1. **成本更优**：10 万/年规模下，平台年费通常比渠道手续费更显著，直连可减少平台层固定支出。
2. **体验可控**：你可以自建统一支付页（方式选择、二维码、结果页），达到类似托管 Checkout 的产品体验。
3. **架构更清晰**：UI 与支付核心逻辑解耦；后端统一订单、回调、对账，长期可维护性更好。
4. **迁移风险更低**：直连后不被单一聚合平台锁定，后续切换支付策略更灵活。

---

## 4. 备选方案对比

### 方案 A：继续聚合平台（如 Ping++）

**优点**

- 接入快、前期研发少
- 多渠道接口统一

**缺点**

- 固定成本偏高（年费/服务费）
- 对平台依赖高，长期可控性一般

**适用**

- MVP 快速上线、短期验证优先

### 方案 B：官方直连（推荐）

**优点**

- 支付成本结构更轻
- 对渠道能力控制更强
- 更适合国内长期运营

**缺点**

- 前后端开发与运维投入更高

**适用**

- 希望中长期成本可控、团队有基础研发能力

### 方案 C：先聚合后迁移

**优点**

- 兼顾速度与长期优化

**缺点**

- 需要一次迁移成本

**适用**

- 当前要快速上线，但已经规划后续降本

---

## 5. 实施建议（分阶段）

## 阶段 1（1~2 周）：最小可用上线

- 前端：支付方式面板 + 微信二维码 + 支付结果页
- 后端：统一下单接口、状态查询接口、回调接口
- 渠道：先接微信扫码与支付宝 H5（覆盖主要场景）

## 阶段 2（2~4 周）：稳定性与运营能力

- 订单超时关闭、主动轮询与回调双保险
- 对账报表与异常告警
- 退款与部分退款流程

## 阶段 3（按需）：扩展能力

- 银联/企业支付等补充渠道
- 支付路由策略（按设备、地区、成功率分流）

---

## 6. 成本判断（简版）

在年交易额约 10 万的量级：

- 直连：主要承担渠道手续费（如 0.6% 量级，实际看商户类目）
- 聚合：渠道手续费 + 平台年费/服务费

因此若团队能承担基础研发与运维，**直连通常更省**。

---

## 7. 风险与控制

- **风险：前端误判成功**
  - 控制：仅以服务端回调/查询作为最终支付结果
- **风险：扫码支付延迟**
  - 控制：轮询 + webhook 双机制，超时关闭订单
- **风险：渠道差异导致逻辑分散**
  - 控制：后端做渠道适配层，统一订单模型

---

## 8. 最终建议

若你当前优先级是“成本 + 可控 + 国内体验”，建议立即执行：

**官方直连为主、收银台自研、支付核心后端统一。**

这条路径在当前规模下性价比最高，也最利于后续扩展。
