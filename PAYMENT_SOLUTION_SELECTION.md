# 支付方案选择建议（国内场景）

## 1. 决策目标

在国内场景下，选择一条可落地的支付实现路径，满足以下目标：

- 能快速上线并可持续维护
- 支持微信/支付宝/银联等主流方式
- 前端可提供类似托管 Checkout 的统一体验
- 后端能统一风控、对账、状态回调处理

---

## 2. 可选方案

## 方案 A：继续使用 Paddle（海外托管 Checkout）

**方案描述**

- 依赖 Paddle 的托管支付页与订阅能力，前端接入最轻。

**优点**

- 接入快，前端工作量低
- 托管式体验完整，默认就有“支付页面”
- 订阅/账单类能力成熟

**缺点**

- 对国内支付习惯（微信扫码、支付宝）支持不够“本地化”
- 在国内业务场景下，支付方式与转化可能受限
- 与国内渠道/规则对接弹性较弱

**适用场景**

- 主要面向海外用户，且以国际卡支付为主

---

## 方案 B：Ping++ + 手写收银台（推荐）

**方案描述**

- 使用 Ping++ 作为支付聚合层；
- 自研前端收银台（支付方式面板、二维码展示、状态页）；
- 后端统一创建 Charge、接收 webhook、维护订单状态。

**优点**

- 可覆盖国内主流支付方式（微信/支付宝/银联）
- 交互体验完全可控，可做成“类似 Paddle”的统一页面
- 后端统一订单模型，便于扩展和治理
- 便于按市场、设备、渠道做精细化路由

**缺点**

- 前后端开发量高于托管 Checkout
- 需要自己承担支付页、状态轮询、异常兜底等工程复杂度
- 订阅自动扣款能力需结合具体渠道能力单独设计

**适用场景**

- 目标用户在国内，强调微信/支付宝支付转化
- 接受“前期开发换后期可控”的路线

---

## 方案 C：直连各渠道（微信/支付宝/银联）不走聚合

**方案描述**

- 后端直接对接各渠道官方接口，前端仍自研收银台。

**优点**

- 通道能力最原生，控制力最高
- 可减少第三方聚合层依赖

**缺点**

- 开发/维护成本最高
- 各渠道协议差异大，测试和运维复杂
- 新增渠道或改版成本高

**适用场景**

- 支付团队成熟，且长期投入充足
- 对通道级能力有强定制诉求

---

## 3. 推荐选择

**推荐：方案 B（Ping++ + 手写收银台）**

**选择原因**

1. 能同时满足“国内支付覆盖”与“统一页面体验”两个核心目标。
2. 比直连渠道实现成本低，比 Paddle 在国内场景更可控。
3. 能保持架构高内聚、低耦合：UI 层与支付核心逻辑分离，后续扩展更稳。

---

## 4. 推荐方案的落地边界

**前端职责（UI 层）**

- 支付方式选择面板
- 微信扫码二维码展示
- 支付中状态提示与轮询

**后端职责（核心逻辑层）**

- 统一下单接口（按 channel 路由）
- webhook 验签与订单状态更新
- 订单查询与超时关闭

**设计原则**

- SRP：页面只处理交互，支付结果以服务端为准
- DRY：统一订单模型、统一回调处理
- SOLID：渠道能力通过适配层隔离，避免业务代码散落

---

## 5. 风险与对策

- **风险：前端误判支付成功**
  - 对策：仅以 webhook/服务端查询作为最终成功依据
- **风险：二维码支付状态延迟**
  - 对策：轮询 + webhook 双通路，设置超时和关闭单逻辑
- **风险：渠道能力差异（订阅、分期、退款细节）**
  - 对策：渠道适配层统一抽象，按能力矩阵控制前端展示

---

## 6. 结论

如果目标是“国内用户 + 类似托管页体验 + 可持续扩展”，推荐采用：

**Ping++（聚合） + 自研收银台（体验） + 服务端统一支付核心（可靠性）**

这条路线在成本、灵活性、可控性之间最均衡。
